import{n as f,v as h,x as v,d as b,y as u,z as l,A as g}from"./index-912c6b30.js";function k(){const e=f({show:!1,background:"rgba(0, 0, 0, 0.7)",message:""}),n=b({setup(){const o=()=>u("div",{class:"spinner-item"}),i=(()=>u("div",{class:"spinner"},new Array(4).fill(null).map(()=>o())))(),a=()=>u("div",{class:"loading-message display-center"},[i,e.message]);return()=>u("div",{class:"loading-box display-center",style:{"background-color":e.background}},[a()])}}),r=h(n),t=document.createElement("div");return document.body.appendChild(t),r.mount(t),{...v(e),instance:r,unmount(){r.unmount(),document.body.removeChild(t)}}}let c;function y(){const{show:e,background:n,message:r,unmount:t}=k(),o={open(s){return s&&(s.background!=null&&(n.value=s.background),s.message!=null&&(r.value=s.message)),e.value=!0,o},close(s=!0){return s?(t(),c=void 0):e.value=!1,o}};return o}function d(){return c||(c=y()),c}const w={open(e){return d().open(e)},close(e=!0){return c?d().close(e):void 0}};function p(e){return e.status===200?Promise.resolve(e.data):Promise.reject(e)}const m=async(e,n="processing...",r=!0)=>{let t;const o=l(),s=()=>{o.loading(!0),t=r&&w.open({message:n,background:"rgba(0, 0, 0, 0.7)"})},i=()=>{o.loading(!1),o.isLoading||t==null||t.close()};s();try{const a=await e;return i(),a}catch(a){return console.error(a),i(),Promise.reject(a)}},C=e=>m(g.post("/api/dsz-api/auth",e)).then(p).then(n=>{n.token&&l().setToken(n.token)}),P=e=>m(g.get("/api/dsz-api/products",e)).then(p);export{C as a,P as g};
